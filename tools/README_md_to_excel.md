# Markdown测试用例转Excel转换器

## 功能概述

这个Python脚本用于将测试用例从Markdown格式转换为Excel格式。它能够：

- 递归扫描指定目录下的所有Markdown文件
- 解析每个文件中的测试用例表格和覆盖范围信息
- 将所有测试用例整合到一个格式化的Excel文件中

## 依赖库安装

### 使用UV环境管理（推荐）

如果项目使用UV管理环境，请运行：

```bash
uv add pandas openpyxl
```

### 使用pip安装

如果使用传统的pip管理，请运行：

```bash
pip install pandas openpyxl
```

## 使用方法

### 基本用法

```bash
# 使用UV环境运行（推荐）
uv run python md_to_excel_converter.py

# 或者直接运行
python md_to_excel_converter.py
```

### 自定义参数

```bash
# 指定输入目录
uv run python md_to_excel_converter.py /path/to/markdown/files

# 指定输入目录和输出文件名
uv run python md_to_excel_converter.py /path/to/markdown/files custom_output.xlsx
```

## 输入文件格式要求

脚本期望的Markdown文件格式如下：

```markdown
## 覆盖范围
- 功能模块描述
- 测试范围说明

## 测试用例（表格）

| 测试用例ID | 测试用例名称 | 前置条件 | 测试步骤 | 预期结果 | 实际结果 | 测试状态 |
|---|---|---|---|---|---|---|
| TC-001 | 测试用例1 | 前置条件1 | 步骤1 | 结果1 | 实际结果1 | 通过 |
| TC-002 | 测试用例2 | 前置条件2 | 步骤2 | 结果2 | 实际结果2 | 失败 |
```

## 输出文件格式

生成的Excel文件包含以下列：

1. **文件名** - 源Markdown文件名
2. **覆盖范围** - 从"## 覆盖范围"部分提取的内容
3. **测试用例ID** - 测试用例的唯一标识符
4. **测试用例名称** - 测试用例的名称
5. **前置条件** - 执行测试前需要满足的条件
6. **测试步骤** - 详细的测试执行步骤
7. **预期结果** - 期望的测试结果
8. **实际结果** - 实际的测试执行结果
9. **测试状态** - 测试的执行状态（通过/失败/待执行等）

## 特性

### 格式化功能
- 自动设置列宽以适应内容
- 标题行使用蓝色背景和白色字体
- 自动换行以显示长文本
- 设置适当的行高

### 错误处理
- 文件读取错误处理
- 目录不存在检查
- 表格解析异常处理
- 详细的错误信息输出

### 进度提示
- 显示扫描到的文件数量
- 显示当前处理进度
- 显示每个文件提取的测试用例数量
- 显示总计统计信息

## 示例输出

```
开始处理Markdown文件...
扫描到 5 个Markdown文件
正在处理 (1/5): 知识库管理_元数据管理_测试用例.md
  提取到 6 个测试用例
正在处理 (2/5): 知识库管理_外部知识库与集成_测试用例.md
  提取到 5 个测试用例
...
总计提取到 28 个测试用例
正在创建Excel文件...
Excel文件已保存: 测试用例汇总.xlsx
转换完成!
```

## 注意事项

1. **文件编码**: 确保Markdown文件使用UTF-8编码
2. **表格格式**: 表格必须包含标准的7列格式
3. **目录权限**: 确保对输入目录有读取权限，对输出目录有写入权限
4. **文件覆盖**: 如果输出文件已存在，将被覆盖

## 故障排除

### 常见问题

1. **"目录不存在"错误**
   - 检查输入目录路径是否正确
   - 确保目录存在且可访问

2. **"没有找到测试用例数据"**
   - 检查Markdown文件是否包含正确格式的表格
   - 确保表格标题行包含"测试用例ID"

3. **Excel文件无法保存**
   - 检查输出目录的写入权限
   - 确保Excel文件没有被其他程序打开

4. **编码错误**
   - 确保Markdown文件使用UTF-8编码保存

### 调试模式

如果遇到问题，可以在脚本中添加调试信息：

```python
# 在parse_markdown_file方法中添加调试输出
print(f"文件内容长度: {len(content)}")
print(f"提取到的覆盖范围: {coverage}")
print(f"提取到的测试用例数量: {len(test_cases)}")
```

## 版本信息

- 版本: 1.0.0
- 创建日期: 2025-09-05
- Python版本要求: >= 3.12
- 依赖库: pandas, openpyxl

## 许可证

本脚本遵循项目的许可证条款。
