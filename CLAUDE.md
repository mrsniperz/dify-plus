# 项目配置

## 编码原则

在进行架构分析、功能模块分析和编码时，请遵循：
1. 分析问题和技术架构时遵循"第一性原理"
2. 编码时遵循 "DRY原则"、"KISS原则"、"SOLID原则"、"YAGNI原则"

## 项目目录结构

项目遵循以下标准化目录结构：

```
项目根目录/
├── scripts/                   # 可执行脚本（安装、部署、维护等）
├── src/                       # 源代码根目录
│   ├── api/                   # API接口层（路由、中间件、处理器）
│   ├── models/                # 数据模型层（实体、仓储、DTO）
│   ├── services/              # 业务逻辑层（业务服务、外部集成、守护进程）
│   ├── schemas/               # 数据结构定义（验证、序列化、迁移）
│   ├── core/                  # 核心功能模块（认证、安全、异常处理）
│   ├── config/                # 配置管理（环境配置、应用设置、常量）
│   └── utils/                 # 工具函数库（助手函数、验证器、格式化）
├── tests/                     # 测试代码目录
│   ├── unit/                  # 单元测试
│   ├── integration/           # 集成测试
│   ├── fixtures/              # 测试数据
│   └── mocks/                 # 模拟对象
├── docs/                      # 开发过程文档
├── test_output/               # 测试输出结果
└── .cursor/docs/              # 项目文档
```

### 目录规则
- **强制性目录**: `src/`, `tests/`, `.cursor/docs/` 必须存在
- **按需创建**: 其他目录根据项目实际需要创建
- **命名规范**: 目录名使用小写字母和下划线 (snake_case)

### 文件放置规则
- **API相关**: 路由、控制器、中间件 → `src/api/`
- **业务逻辑**: 服务类、业务规则 → `src/services/`
- **数据层**: 模型、仓储、DTO → `src/models/`
- **配置文件**: 环境配置、应用设置 → `src/config/`
- **工具函数**: 通用工具、助手函数 → `src/utils/`
- **测试文件**: 所有测试代码 → `tests/`
- **脚本文件**: 可执行脚本 → `scripts/`

## Python 环境管理

本项目使用 **UV** 管理 Python 环境和依赖。

### UV 环境检测
在执行任何 Python 相关操作前，检查：
- 项目根目录是否存在 `pyproject.toml` 文件
- 是否存在 `uv.lock` 文件

### UV 命令使用
- **运行测试**: `uv run pytest` 或 `uv run python -m pytest`
- **运行脚本**: `uv run python script.py`
- **添加依赖**: `uv add package_name`
- **添加开发依赖**: `uv add --dev package_name`
- **移除依赖**: `uv remove package_name`
- **同步环境**: `uv sync`

### 注意事项
- 始终在 UV 管理的虚拟环境中执行 Python 命令
- **避免直接使用 `pip` 命令**，以免破坏 UV 的依赖管理
- 在执行任何包管理操作前，确认当前处于正确的项目目录

## 文档更新规则

### 自动文档更新要求
当完成以下任何类型的任务后，**必须**主动使用 `doc-management` skill更新相关文档：

**必须更新文档的场景：**
- ✅ 新增功能模块或组件
- ✅ 修改现有功能或业务逻辑
- ✅ 新增、修改或删除 API 接口
- ✅ 架构调整、重构或模块重组
- ✅ 修复 bug（记录到 CHANGELOG）
- ✅ 性能优化或算法改进
- ✅ 依赖库新增、更新或移除
- ✅ 部署流程、配置或环境变更
- ✅ 数据库模型或表结构变更
- ✅ 安全策略或认证机制调整

### 文档同步执行原则
1. **即时性**：文档更新应在代码变更完成后立即执行，不得延迟
2. **完整性**：确保所有相关文档都得到更新，避免遗漏
3. **准确性**：文档内容必须与代码实际情况完全一致
4. **可追溯性**：CHANGELOG.md 必须记录所有重要变更，包含日期和影响范围
